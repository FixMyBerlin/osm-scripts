# About

The scripts here use OSM data to generate maps for https://www.zesplus.de/forschungsprojekt. Those maps are used to plan the bicycle infrastructure in the reagion.

Details can be found in the README files in each folder.

## TODOs

- [ ] Add link to general process documentation

## List of files

All generated files are listed at https://osm-scripts.netlify.app/AllFiles/AllFiles.json

## General process

1. Run `npm run build:netlify`
2. Upload data to Mapbox Studio using [the Tileset web uploader](https://studio.mapbox.com/tilesets/)

**For the [allHighways.geojson](./Highways/output/allHighways.geojson)**

We need to prepare the data before uploading it. Uploading it direcly does not give us control over the min/max zoom level of the data. Using [tippecanoe](https://github.com/mapbox/tippecanoe) allows us to do just that.

Run this command from the folder `./Highways/output/`

```
tippecanoe -z16 -Z10 -o zesplus-allhighways.mbtiles --drop-densest-as-needed --name="ZES+ AllHighways" --attribution="OpenStreetMap Contributors, FixMyCity" --description="https://github.com/FixMyBerlin/osm-scripts/tree/main/ZESPlus" allHighways.geojson
```

## Custom properties

**General custom properties:**

- `"FMC:Category:poiEducation": "true"` – An overall category for the given feature. It references the file generated by the scripts.
- `"FMC:DataCreatedAndProcessedAt": "2022-03-02 15:27"` – DateTime of the processing, which is usually right after we downloaded the data.
- `"FMC:linkToMapillary": "https://www.mapillary.com/app/?lat=52.40392&lng=13.569952&z=16&focus=map"` – A link to Mapillary for the given location. Will pick the center of the way if given.
- `"FMC:linkToOsmWebsite": "https://www.openstreetmap.org/way/24154870"` – A link to the given OSM object.
- `"FMC:length": "163.804"` – Length of the segment in meter, calculated by Overpass.

**Highways: Custom area properties:**

Files that are based on "Highways-PrepareData" hold a set of custom properties that describe the area that the way belongs to.

The areas are specified in [`AreaOfInterest/areas.constant.ts`](./AreaOfInterest/areas.constant.ts). We include only a few for performance reasons.

We check for an overlap with a given area. Therefore a way may be part of multipe areas.

- `"FMC:Gebiete": "Eichwalde,"` – A list of all areas, that this way belongs to.
- `"FMC:Gebiete:Zeuthen": "false"` – Specifies if the way has an overlap with the given area.
- `"FMC:Gebiete:Eichwalde": "true"` – Same
- `"FMC:Gebiete:Schulzendorf": "false"` – Same
- `"FMC:Gebiete:Wildau": "false"` – Same

**Data set specific custom properties:**

Each data set has a README which explaints custom properties specific to that data set.
